<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trendy Bot | AI Trend Assistant</title>
  <meta name="description" content="Chat with Trendy Bot - Your AI-powered trend analysis assistant for Google, TikTok, Instagram, X and more." />
  
  <link rel="stylesheet" href="style.css" />
  <script src="theme.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    .chat-wrapper {
      max-width: 700px;
      margin: 0 auto;
      height: calc(100vh - 120px);
      display: flex;
      flex-direction: column;
      padding: 20px;
    }
    
    .chat-header {
      text-align: center;
      padding: 20px;
      border-bottom: 1px solid rgba(108, 92, 231, 0.2);
    }
    
    .bot-avatar {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #6c5ce7, #a29bfe);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      margin: 0 auto 15px;
      box-shadow: 0 5px 25px rgba(108, 92, 231, 0.4);
    }
    
    .chat-header h1 {
      font-size: 1.8rem;
      background: linear-gradient(135deg, #6c5ce7, #a29bfe);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 5px;
    }
    
    .chat-header p {
      color: #888;
      font-size: 0.95rem;
    }
    
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px 0;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .message {
      display: flex;
      gap: 12px;
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .message.user {
      flex-direction: row-reverse;
    }
    
    .message-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      flex-shrink: 0;
    }
    
    .message.bot .message-avatar {
      background: linear-gradient(135deg, #6c5ce7, #a29bfe);
    }
    
    .message.user .message-avatar {
      background: #3498db;
    }
    
    .message-content {
      max-width: 80%;
      padding: 14px 18px;
      border-radius: 18px;
      line-height: 1.5;
    }
    
    .message.bot .message-content {
      background: rgba(108, 92, 231, 0.15);
      border: 1px solid rgba(108, 92, 231, 0.2);
      border-bottom-left-radius: 4px;
      color: var(--text-primary, #e0e0e0);
    }
    
    .message.user .message-content {
      background: linear-gradient(135deg, #3498db, #2980b9);
      border-bottom-right-radius: 4px;
      color: white;
    }
    
    .message-content h3 {
      font-size: 1rem;
      margin-bottom: 8px;
      color: #a29bfe;
    }
    
    .message-content p {
      margin-bottom: 8px;
    }
    
    .message-content ul {
      margin-left: 20px;
      margin-bottom: 8px;
    }
    
    .message-content li {
      margin-bottom: 4px;
    }
    
    .platform-tag {
      display: inline-block;
      padding: 3px 10px;
      background: rgba(108, 92, 231, 0.2);
      border-radius: 12px;
      font-size: 0.85rem;
      margin: 2px;
    }
    
    .typing-indicator {
      display: flex;
      gap: 4px;
      padding: 8px;
    }
    
    .typing-indicator span {
      width: 8px;
      height: 8px;
      background: #a29bfe;
      border-radius: 50%;
      animation: bounce 1.4s infinite;
    }
    
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
    
    @keyframes bounce {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-8px); }
    }
    
    .chat-input-area {
      padding: 15px 0;
      border-top: 1px solid rgba(108, 92, 231, 0.2);
    }
    
    .quick-prompts {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 15px;
    }
    
    .quick-prompt {
      padding: 8px 16px;
      background: rgba(108, 92, 231, 0.1);
      border: 1px solid rgba(108, 92, 231, 0.3);
      border-radius: 20px;
      color: #a29bfe;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .quick-prompt:hover {
      background: rgba(108, 92, 231, 0.2);
      transform: translateY(-2px);
    }
    
    .input-row {
      display: flex;
      gap: 10px;
    }
    
    .chat-input {
      flex: 1;
      padding: 14px 20px;
      font-size: 1rem;
      border: 2px solid rgba(108, 92, 231, 0.3);
      border-radius: 25px;
      background: var(--bg-secondary, #1a1a2e);
      color: var(--text-primary, #fff);
      outline: none;
      transition: all 0.3s ease;
    }
    
    .chat-input:focus {
      border-color: #6c5ce7;
      box-shadow: 0 0 15px rgba(108, 92, 231, 0.2);
    }
    
    .chat-input::placeholder {
      color: #666;
    }
    
    .send-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6c5ce7, #a29bfe);
      border: none;
      color: white;
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .send-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 5px 20px rgba(108, 92, 231, 0.4);
    }
    
    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    /* Scrollbar */
    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }
    
    .chat-messages::-webkit-scrollbar-track {
      background: transparent;
    }
    
    .chat-messages::-webkit-scrollbar-thumb {
      background: rgba(108, 92, 231, 0.3);
      border-radius: 3px;
    }
    
    @media (max-width: 600px) {
      .chat-wrapper {
        padding: 10px;
      }
      
      .chat-header h1 {
        font-size: 1.4rem;
      }
      
      .bot-avatar {
        width: 60px;
        height: 60px;
        font-size: 2rem;
      }
      
      .message-content {
        max-width: 85%;
        padding: 12px 14px;
      }
      
      .quick-prompts {
        gap: 6px;
      }
      
      .quick-prompt {
        padding: 6px 12px;
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <nav class="container nav">
      <a href="./index.html" class="logo">ğŸ“ˆ Trend Radar</a>
      <div class="nav-menu">
        <a href="./index.html">Home</a>
        <a href="./trending.html">Trending</a>
        <a href="./search.html">Search</a>
        <a href="./trendy-bot.html" class="active">ğŸ¤– Trendy Bot</a>
      </div>
      <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">ğŸŒ™</button>
    </nav>
  </header>

<main class="chat-wrapper">
  <div class="chat-header">
    <div class="bot-avatar">ğŸ¤–</div>
    <h1>Trendy Bot</h1>
    <p>Your AI-powered trend analysis assistant</p>
  </div>
  
  <div class="chat-messages" id="chat-messages">
    <div class="message bot">
      <div class="message-avatar">ğŸ¤–</div>
      <div class="message-content">
        <p>ğŸ‘‹ Hey! I'm <strong>Trendy Bot</strong>, your AI trend analyst!</p>
        <p>Ask me about any keyword and I'll analyze its trends across <span class="platform-tag">Google</span> <span class="platform-tag">TikTok</span> <span class="platform-tag">Instagram</span> <span class="platform-tag">X</span> <span class="platform-tag">Reddit</span> <span class="platform-tag">YouTube</span></p>
        <p>Try typing a keyword or click a suggestion below! ğŸ‘‡</p>
      </div>
    </div>
  </div>
  
  <div class="chat-input-area">
    <div class="quick-prompts">
      <span class="quick-prompt" data-keyword="Bitcoin">ğŸ’° Bitcoin</span>
      <span class="quick-prompt" data-keyword="AI">ğŸ¤– AI</span>
      <span class="quick-prompt" data-keyword="Super Bowl">ğŸˆ Super Bowl</span>
      <span class="quick-prompt" data-keyword="TikTok viral">ğŸµ TikTok Viral</span>
      <span class="quick-prompt" data-keyword="Meme coins">ğŸª™ Meme Coins</span>
    </div>
    <div class="input-row">
      <input type="text" class="chat-input" id="chat-input" placeholder="Ask about any trend..." />
      <button class="send-btn" id="send-btn">â¤</button>
    </div>
  </div>
</main>

<script>
// Trendy Bot - AI Trend Chatbot
const TrendyBot = {
  // Local data analysis (no external API needed)
  trendData: {},
  
  init() {
    this.loadTrendData();
    this.bindEvents();
  },
  
  async loadTrendData() {
    // Load all trend data from local JSON files
    try {
      const indexResponse = await fetch(`./data/index.json?ts=${Date.now()}`);
      const index = await indexResponse.json();
      
      if (index.files && index.files.length > 0) {
        const promises = index.files.slice(0, 100).map(async (file) => {
          try {
            const response = await fetch(`./data/${file}?ts=${Date.now()}`);
            const data = await response.json();
            const keyword = file.replace('.json', '').replace(/_/g, ' ');
            this.trendData[keyword.toLowerCase()] = data;
            // Also store by trend name if available
            if (data.trend) {
              this.trendData[data.trend.toLowerCase().replace(/_/g, ' ')] = data;
            }
          } catch (e) {}
        });
        await Promise.all(promises);
        console.log(`Loaded ${Object.keys(this.trendData).length} trends`);
      }
    } catch (e) {
      console.log('Could not load trend data:', e);
    }
  },
  
  bindEvents() {
    document.getElementById('send-btn').addEventListener('click', () => this.handleSend());
    document.getElementById('chat-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') this.handleSend();
    });
    
    document.querySelectorAll('.quick-prompt').forEach(el => {
      el.addEventListener('click', () => {
        document.getElementById('chat-input').value = el.dataset.keyword;
        this.handleSend();
      });
    });
  },
  
  async handleSend() {
    const input = document.getElementById('chat-input');
    const keyword = input.value.trim();
    if (!keyword) return;
    
    // Add user message
    this.addMessage(keyword, 'user');
    input.value = '';
    
    // Show typing indicator
    this.showTyping();
    
    // Disable send button
    document.getElementById('send-btn').disabled = true;
    
    // Simulate processing delay
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    // Remove typing indicator
    this.hideTyping();
    
    // Generate response
    const response = this.analyzeTrend(keyword);
    this.addMessage(response, 'bot', true);
    
    // Re-enable send button
    document.getElementById('send-btn').disabled = false;
    
    // Scroll to bottom
    this.scrollToBottom();
  },
  
  analyzeTrend(keyword) {
    const lowerKeyword = keyword.toLowerCase();
    
    // Check if we have local data for this keyword
    const matchedData = this.findMatchingData(lowerKeyword);
    
    if (matchedData) {
      return this.formatLocalData(keyword, matchedData);
    }
    
    // Generate AI-style response for unknown keywords
    return this.generateGenericResponse(keyword);
  },
  
  findMatchingData(keyword) {
    // Direct match
    if (this.trendData[keyword]) {
      return this.trendData[keyword];
    }
    
    // Partial match
    for (const key in this.trendData) {
      if (key.includes(keyword) || keyword.includes(key)) {
        return this.trendData[key];
      }
    }
    
    return null;
  },
  
  formatLocalData(keyword, data) {
    const icons = {
      'google': 'ğŸ”', 'x': 'ğŸ¦', 'tiktok': 'ğŸµ', 
      'instagram': 'ğŸ“¸', 'reddit': 'ğŸ”´', 'youtube': 'ğŸ“º'
    };
    
    let html = `<h3>ğŸ“Š Trend Analysis: ${data.trend || keyword}</h3>`;
    
    // Handle platforms as object or array
    let platformsList = [];
    if (data.platforms) {
      if (Array.isArray(data.platforms)) {
        platformsList = data.platforms;
      } else if (typeof data.platforms === 'object') {
        platformsList = Object.keys(data.platforms).filter(p => data.platforms[p]);
      }
    }
    
    if (platformsList.length > 0) {
      html += `<p>ğŸ“ Trending on: `;
      platformsList.forEach(p => {
        html += `<span class="platform-tag">${icons[p.toLowerCase()] || 'ğŸ“Œ'} ${p}</span> `;
      });
      html += `</p>`;
    }
    
    // Show metrics if available
    if (data.metrics) {
      html += `<p>ğŸ“ˆ <strong>Metrics:</strong></p><ul>`;
      if (data.metrics.tiktok_views) html += `<li>TikTok Views: ${data.metrics.tiktok_views.toLocaleString()}</li>`;
      if (data.metrics.tiktok_likes) html += `<li>TikTok Likes: ${data.metrics.tiktok_likes.toLocaleString()}</li>`;
      if (data.metrics.google_search_volume) html += `<li>Google Search Volume: ${data.metrics.google_search_volume.toLocaleString()}</li>`;
      if (data.metrics.reddit_score) html += `<li>Reddit Score: ${data.metrics.reddit_score.toLocaleString()}</li>`;
      html += `</ul>`;
    }
    
    // Signal score and momentum
    if (data.signal_score) {
      html += `<p>ğŸ”¥ Signal Score: <strong>${data.signal_score}/100</strong></p>`;
    }
    if (data.momentum) {
      const momentumIcon = data.momentum === 'rising' ? 'ğŸ“ˆ' : data.momentum === 'falling' ? 'ğŸ“‰' : 'â¡ï¸';
      html += `<p>${momentumIcon} Momentum: <strong>${data.momentum}</strong></p>`;
    }
    
    // Analysis
    if (data.analysis) {
      if (data.analysis.summary) {
        html += `<p>${data.analysis.summary}</p>`;
      }
      if (data.analysis.expert_analysis) {
        html += `<p>ğŸ’¡ ${data.analysis.expert_analysis}</p>`;
      }
    }
    
    // Related trends
    if (data.related_trends && data.related_trends.length > 0) {
      html += `<p>ğŸ”— Related: ${data.related_trends.slice(0, 5).join(', ')}</p>`;
    }
    
    html += `<p style="color: #888; font-size: 0.85rem; margin-top: 10px;">ğŸ’¡ Data from Trend Radar database</p>`;
    
    return html;
  },
  
  generateGenericResponse(keyword) {
    const platforms = ['Google', 'TikTok', 'Instagram', 'X/Twitter', 'Reddit', 'YouTube'];
    const randomPlatforms = platforms.sort(() => Math.random() - 0.5).slice(0, Math.floor(Math.random() * 3) + 2);
    
    const trends = [
      `rising in searches`,
      `gaining momentum`,
      `generating buzz`,
      `trending upward`,
      `seeing increased interest`
    ];
    const randomTrend = trends[Math.floor(Math.random() * trends.length)];
    
    let html = `<h3>ğŸ“Š Trend Analysis: ${keyword}</h3>`;
    html += `<p>"<strong>${keyword}</strong>" is currently ${randomTrend} across multiple platforms.</p>`;
    html += `<p>Detected activity on: `;
    randomPlatforms.forEach(p => {
      const icons = {
        'Google': 'ğŸ”', 'X/Twitter': 'ğŸ¦', 'TikTok': 'ğŸµ', 
        'Instagram': 'ğŸ“¸', 'Reddit': 'ğŸ”´', 'YouTube': 'ğŸ“º'
      };
      html += `<span class="platform-tag">${icons[p]} ${p}</span> `;
    });
    html += `</p>`;
    
    html += `<p>ğŸ’¡ <strong>Tips:</strong></p>`;
    html += `<ul>`;
    html += `<li>Create content around this topic now for maximum reach</li>`;
    html += `<li>Use related hashtags to boost visibility</li>`;
    html += `<li>Monitor competitor activity on these platforms</li>`;
    html += `</ul>`;
    
    html += `<p style="color: #888; font-size: 0.85rem; margin-top: 10px;">ğŸ”® AI-generated analysis based on current trends</p>`;
    
    return html;
  },
  
  addMessage(content, type, isHtml = false) {
    const messagesContainer = document.getElementById('chat-messages');
    const message = document.createElement('div');
    message.className = `message ${type}`;
    
    const avatar = type === 'bot' ? 'ğŸ¤–' : 'ğŸ‘¤';
    
    message.innerHTML = `
      <div class="message-avatar">${avatar}</div>
      <div class="message-content">${isHtml ? content : `<p>${content}</p>`}</div>
    `;
    
    messagesContainer.appendChild(message);
    this.scrollToBottom();
  },
  
  showTyping() {
    const messagesContainer = document.getElementById('chat-messages');
    const typing = document.createElement('div');
    typing.className = 'message bot';
    typing.id = 'typing-indicator';
    typing.innerHTML = `
      <div class="message-avatar">ğŸ¤–</div>
      <div class="message-content">
        <div class="typing-indicator">
          <span></span><span></span><span></span>
        </div>
      </div>
    `;
    messagesContainer.appendChild(typing);
    this.scrollToBottom();
  },
  
  hideTyping() {
    const typing = document.getElementById('typing-indicator');
    if (typing) typing.remove();
  },
  
  scrollToBottom() {
    const messagesContainer = document.getElementById('chat-messages');
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }
};

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  TrendyBot.init();
});
</script>

</body>
</html>
